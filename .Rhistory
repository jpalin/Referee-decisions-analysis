useLibs()
ggplot(allcards, aes(x=mins)) +
geom_histogram(color="black", fill="#B4C6E7",binwidth=1.0) +
ggtitle("Histogram of time distribution of cards") +
theme(plot.title = element_text(size=16,hjust = 0.5),axis.title.x = element_text(size=12, vjust=-0.5),axis.title.y = element_text(size=12, vjust=+0.5)) +
xlab("Playing time (minutes)") +
ylab("Card count")
useLibs()
addFirstHalfTime <- function(f) {
for(i in 1:length(f$season)){
f$first_half_time[i] = first_half_time(f$period_minute[i], f$period_second[i])
}
return(f)
}
fixture <- addFirstHalfTime(fixture)
addFirstHalfTimeToEvents <- function(g) {
for(i in 1:length(g$season))
g$first_half_time[i] = fixture %>% filter(season == g$season[i] & fixture == g$fixture[i]) %>% select(first_half_time)
return(g)
}
Teams = c("Manchester United", "Chelsea", "Manchester City", "Arsenal", "Tottenham Hotspur", "Liverpool", "Everton", "Fulham", "Aston Villa", "Sunderland", "West Bromwich Albion", "Newcastle United", "Stoke City", "Bolton Wanderers", "Blackburn Rovers", "Wigan Athletic", "Wolverhampton Wanderers", "Birmingham City", "Blackpool", "West Ham United"
,"Swansea City", "Norwich City", "Cardiff City", "Queens Park Rangers", "Southampton", "Reading", "Hull City", "Crystal Palace", "Burnley", "Leicester City")
#Creates array with all refs in dataset
Refs = c("Ref01", "Ref02", "Ref03", "Ref04", "Ref05", "Ref06", "Ref07", "Ref08", "Ref09", "Ref10", "Ref11", "Ref12", "Ref13", "Ref14", "Ref15", "Ref16", "Ref17", "Ref18")
save.image("C:/UP825066/.RData")
ggplot(allcards, aes(x=mins)) +
geom_histogram(color="black", fill="#B4C6E7",binwidth=1.0) +
ggtitle("Histogram of time distribution of cards") +
theme(plot.title = element_text(size=16,hjust = 0.5),axis.title.x = element_text(size=12, vjust=-0.5),axis.title.y = element_text(size=12, vjust=+0.5)) +
xlab("Playing time (minutes)") +
ylab("Card count")
ggplot(allcards, aes(x=mins)) +
geom_histogram(color="black", fill="#B4C6E7",binwidth=1.0) +
ggtitle("Histogram of time distribution of cards") +
theme(plot.title = element_text(size=16,hjust = 0.5),axis.title.x = element_text(size=12, vjust=-0.5),axis.title.y = element_text(size=12, vjust=+0.5)) +
xlab("Playing time (minutes)") +
ylab("Card count")
save.image("C:/UP825066/.RData")
useLibs()
ggplot(allcards, aes(x=mins)) +
geom_histogram(color="black", fill="#B4C6E7",binwidth=1.0) +
ggtitle("Histogram of time distribution of cards") +
theme(plot.title = element_text(size=16,hjust = 0.5),axis.title.x = element_text(size=12, vjust=-0.5),axis.title.y = element_text(size=12, vjust=+0.5)) +
xlab("Playing time (minutes)") +
ylab("Card count")
save.image("C:/UP825066/.RData")
useLibs()
ggplot(allcardslessPI, aes(x=card_number,y= mins)) +
#scale_y_time() +
geom_point(size=0.1, shape = ".") +
scale_x_discrete(limits=c("1","2","3","4","5","6","7","8","9","10","11")) +
theme(plot.title = element_text(size=16,hjust = 0.5),axis.title.x = element_text(size=12, vjust=-0.5),axis.title.y = element_text(size=12, vjust=+0.5)) +
ggtitle("Playing times for each card number (all games)") +
xlab("Card number") +
ylab("Playing time (mins)") +
geom_boxplot(fill='#B4C6E7', color="black") +
stat_summary(fun.y="mean",color="red") +
stat_summary(
fun.data = stat_box_data2,
geom = "text",
hjust = 0.5,
vjust = 0.9
) +
scale_y_continuous(limits=c(0,130), breaks=seq(0,130,10))
ggplot(teamDAs, aes(official, yellow)) +
geom_point(size=0.1, shape = ".") +
scale_x_discrete(limits=c("Ref05","Ref06","Ref09","Ref17","Ref10","Ref11","Ref18","Ref12","Ref07","Ref14","Ref16","Ref04","Ref01","Ref15","Ref08","Ref13","Ref02","Ref03")) +
theme(plot.caption = element_text(size=12,face="italic",hjust = 0),plot.title = element_text(size=16,hjust = 0.5),axis.title.x = element_text(size=12, vjust=-0.5),axis.title.y = element_text(size=12, vjust=+0.5)) +
ggtitle("Number of yellow cards (all teams) for each referee") +
xlab("Referee") +
ylab("Number of yellow cards") +
labs(caption = "Plots ordered left to right by mean number of yellow cards (red dot) for each referee") +
geom_boxplot(fill='#B4C6E7', color="black") +
stat_summary(fun.y="mean",color="red") +
scale_y_continuous(limits=c(0,8), breaks=seq(0,8,0.5))
ggplot(gameDAs, aes(official, yellow)) +
geom_point(size=0.1, shape = ".") +
scale_x_discrete(limits=c("Ref05","Ref06","Ref09","Ref07","Ref10","Ref14","Ref18","Ref11","Ref12","Ref17","Ref01","Ref04","Ref08","Ref15","Ref16","Ref02","Ref13","Ref03")) +
theme(plot.title = element_text(hjust = 0.5),axis.title.x = element_text(vjust=-0.5),axis.title.y = element_text(vjust=+0.5)) +
ggtitle("Distribution of the number of yellow cards issued for each referee") +
xlab("Referee") +
ylab("Yellow cards per match") +
geom_boxplot(fill='#B4C6E7', color="black") +
scale_y_continuous(limits=c(0,11), breaks=seq(0,11,1))
save.image("C:/UP825066/.RData")
